{% extends 'core/base.html' %}
{% load static %}

{% block title %}Payment Successful - GymWord{% endblock %}

{% block content %}
<section class="payment-success-section py-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 offset-lg-2">
                <div class="card shadow">
                    <div class="card-header bg-success text-white">
                        <h2 class="mb-0">Payment Successful!</h2>
                    </div>
                    <div class="card-body">
                        <div class="text-center mb-4">
                            <i class="fas fa-check-circle text-success" style="font-size: 64px;"></i>
                            <h3 class="mt-3">Thank you for your purchase!</h3>
                            <p>Your transaction has been completed successfully.</p>
                        </div>
                        
                        <div class="receipt-container p-3 border rounded">
                            <h4>Receipt</h4>
                            <div class="receipt-details">
                                <div class="row">
                                    <div class="col-md-6">
                                        <p><strong>Order ID:</strong> {{ receipt_data.order_id }}</p>
                                        <p><strong>Date:</strong> {{ receipt_data.date }}</p>
                                        <p><strong>Payment Method:</strong> {{ receipt_data.payment_method }}</p>
                                    </div>
                                    <div class="col-md-6">
                                        <p><strong>Customer:</strong> {{ receipt_data.customer }}</p>
                                        <p><strong>Email:</strong> {{ receipt_data.email }}</p>
                                    </div>
                                </div>
                                
                                <div class="table-responsive mt-3">
                                    <table class="table table-bordered">
                                        <thead>
                                            <tr>
                                                <th>Item</th>
                                                <th>Price</th>
                                                <th>Quantity</th>
                                                <th>Total</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for item in receipt_data.items %}
                                            <tr>
                                                <td>{{ item.name }}</td>
                                                <td>${{ item.price }}</td>
                                                <td>{{ item.quantity }}</td>
                                                <td>${{ item.total }}</td>
                                            </tr>
                                            {% empty %}
                                            <tr>
                                                <td colspan="4" class="text-center">No items</td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                        <tfoot>
                                            <tr>
                                                <th colspan="3" class="text-right">Total:</th>
                                                <th>${{ receipt_data.total }}</th>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center mt-4">
                            <button class="btn btn-primary" id="printReceipt">
                                <i class="fas fa-print mr-2"></i> Print Receipt
                            </button>
                            <a href="{% url 'booking_history' %}" class="btn btn-info ml-2">
                                <i class="fas fa-history mr-2"></i> View Booking History
                            </a>
                            <a href="{% url 'home' %}" class="btn btn-outline-primary ml-2">
                                <i class="fas fa-home mr-2"></i> Return to Home
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Print receipt functionality
        const printReceiptBtn = document.getElementById('printReceipt');
        if (printReceiptBtn) {
            printReceiptBtn.addEventListener('click', function() {
                const receiptContent = document.querySelector('.receipt-container').innerHTML;
                const printWindow = window.open('', '_blank');
                printWindow.document.write(`
                    <html>
                    <head>
                        <title>Payment Receipt</title>
                        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
                        <style>
                            body { padding: 20px; }
                            .receipt-header { text-align: center; margin-bottom: 20px; }
                            .receipt-footer { text-align: center; margin-top: 30px; font-size: 14px; }
                        </style>
                    </head>
                    <body>
                        <div class="receipt-header">
                            <h2>GymWord</h2>
                            <p>123 Fitness Street, Gym City, GC 12345</p>
                            <p>Tel: +1 (123) 456-7890 | Email: info@gymword.com</p>
                        </div>
                        ${receiptContent}
                        <div class="receipt-footer">
                            <p>Thank you for your business!</p>
                            <p>For any questions, please contact our customer service.</p>
                        </div>
                    </body>
                    </html>
                `);
                printWindow.document.close();
                printWindow.focus();
                setTimeout(() => {
                    printWindow.print();
                    printWindow.close();
                }, 500);
            });
        }
    });
</script>
{% endblock %}

